(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aba6595c"],{1138:function(t,e,a){},"33f2":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"add"}},[e("el-steps",{staticClass:"steps",attrs:{active:t.active,"align-center":"","process-status":"wait"}},[e("el-step",{attrs:{title:"填写商品基本信息"}}),e("el-step",{attrs:{title:"填写商品销售信息"}})],1),e("div",{staticClass:"edit-form"},[e("Basic",{directives:[{name:"show",rawName:"v-show",value:1===t.active,expression:"active === 1"}],attrs:{options:t.options,categoryList:t.categoryList,dataForm:t.dataForm},on:{handleSubmit:t.next}}),e("Sales",{directives:[{name:"show",rawName:"v-show",value:2===t.active,expression:"active === 2"}],attrs:{dataForm:t.dataForm},on:{prev:t.prev,handleSubmit:t.handleSubmit}})],1)],1)},r=[],i=(a("14d9"),function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"basic"}},[e("el-form",{ref:"dataForm",staticClass:"demo-ruleForm",attrs:{model:t.dataForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"标题",prop:"title"}},[e("el-input",{model:{value:t.dataForm.title,callback:function(e){t.$set(t.dataForm,"title",e)},expression:"dataForm.title"}})],1),e("el-form-item",{attrs:{label:"商品描述",prop:"desc"}},[e("el-input",{model:{value:t.dataForm.desc,callback:function(e){t.$set(t.dataForm,"desc",e)},expression:"dataForm.desc"}})],1),e("el-form-item",{staticClass:"form-category",attrs:{label:"商品类目",prop:"category"}},[e("el-select",{staticClass:"category",attrs:{placeholder:"请选择商品类目"},model:{value:t.dataForm.category,callback:function(e){t.$set(t.dataForm,"category",e)},expression:"dataForm.category"}},t._l(t.categoryList,(function(t){return e("el-option",{key:t._id,attrs:{label:t.name,value:t.name}})})),1),e("el-select",{staticClass:"sonCategory",attrs:{placeholder:"请选择子类目"},model:{value:t.dataForm.sonCategory,callback:function(e){t.$set(t.dataForm,"sonCategory",e)},expression:"dataForm.sonCategory"}},t._l(t.sonCategoryList,(function(t,a){return e("el-option",{key:a,attrs:{label:t,value:t}})})),1)],1),e("el-form-item",{attrs:{label:"商品标签",prop:"tags"}},[e("el-select",{staticClass:"tags",attrs:{multiple:"",filterable:"","allow-create":"","default-first-option":""},model:{value:t.dataForm.tags,callback:function(e){t.$set(t.dataForm,"tags",e)},expression:"dataForm.tags"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("dataForm")}}},[t._v("下一步")])],1)],1)],1)}),o=[],l={data(){return{rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],category:[{required:!0,message:"请选择商品类目",trigger:"change"}],tags:[{required:!0,message:"请选择商品标签",trigger:"change"}]}}},props:["categoryList","options","dataForm"],watch:{},computed:{sonCategoryList(){if(!this.dataForm.category)return[];const t=this.categoryList.filter(t=>t.name===this.dataForm.category);return t[0].c_items}},methods:{submitForm(t){this.$refs[t].validate(t=>t?this.$emit("handleSubmit",this.dataForm):(console.log("error submit!!"),!1))}}},n=l,c=(a("8be4"),a("2877")),d=Object(c["a"])(n,i,o,!1,null,"dde0c8ae",null),u=d.exports,m=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"sales"}},[e("el-form",{ref:"dataForm",staticClass:"demo-ruleForm",attrs:{model:t.dataForm,rules:t.rules,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"商品售价",prop:"price"}},[e("el-input",{model:{value:t.dataForm.price,callback:function(e){t.$set(t.dataForm,"price",e)},expression:"dataForm.price"}})],1),e("el-form-item",{attrs:{label:"折扣价格",prop:"price_off"}},[e("el-input",{model:{value:t.dataForm.price_off,callback:function(e){t.$set(t.dataForm,"price_off",e)},expression:"dataForm.price_off"}})],1),e("el-form-item",{attrs:{label:"商品库存",prop:"inventory"}},[e("el-input",{model:{value:t.dataForm.inventory,callback:function(e){t.$set(t.dataForm,"inventory",e)},expression:"dataForm.inventory"}})],1),e("el-form-item",{attrs:{label:"计量单位",prop:"unit"}},[e("el-input",{model:{value:t.dataForm.unit,callback:function(e){t.$set(t.dataForm,"unit",e)},expression:"dataForm.unit"}})],1),e("el-form-item",{attrs:{label:"商品相册",prop:"images"}},[e("div",{staticClass:"uploadImg"},[e("el-upload",{ref:"uploadImg",attrs:{action:"https://mallapi.duyiedu.com/upload/images?appkey="+t.$store.state.userInfo.appkey,"list-type":"picture-card","file-list":t.filesList,"on-change":t.handleImageChange},scopedSlots:t._u([{key:"file",fn:function({file:a}){return e("div",{},[e("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:a.url,alt:""}}),e("span",{staticClass:"el-upload-list__item-actions"},[e("span",{staticClass:"el-upload-list__item-preview",on:{click:function(e){return t.handlePictureCardPreview(a)}}},[e("i",{staticClass:"el-icon-zoom-in"})]),t.disabled?t._e():e("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleDownload(a)}}},[e("i",{staticClass:"el-icon-download"})]),t.disabled?t._e():e("span",{staticClass:"el-upload-list__item-delete",on:{click:function(e){return t.handleRemove(a)}}},[e("i",{staticClass:"el-icon-delete"})])])])}}])},[e("i",{staticClass:"el-icon-plus",attrs:{slot:"default"},slot:"default"})])],1),e("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})])],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.prev}},[t._v("上一步")]),e("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("dataForm")}}},[t._v("提交")])],1)],1)],1)},p=[],g={data(){return{dialogImageUrl:"",dialogVisible:!1,disabled:!1,rules:{price:[{required:!0,message:"请输入商品价格",trigger:"blur"}],unit:[{required:!0,message:"请输入计量单位",trigger:"blur"}],inventory:[{required:!0,message:"请输入商品库存",trigger:"blur"}],images:[{required:!0,message:"请上传图片",trigger:"change"}]}}},props:["dataForm"],computed:{filesList(){console.log("dataForm",this.dataForm);const t=this.dataForm.images.map((t,e)=>({name:`image-${e}.png`,status:"success",uid:e,url:t}));return t}},methods:{prev(){this.$emit("prev",this.dataForm)},submitForm(t){this.$refs[t].validate(t=>t?this.$emit("handleSubmit",this.dataForm):(console.log("error submit!!"),!1))},handleRemove(t){let{uploadFiles:e}=this.$refs.uploadImg;e=e.filter(e=>e.url!==t.url),console.log(e),this.dataForm.images=e},handlePictureCardPreview(t){this.dialogImageUrl=t.url,this.dialogVisible=!0},handleDownload(t){console.log(t)},handleImageChange(t,e){this.dataForm.images=e,this.$refs.dataForm.validateField("images")}}},f=g,h=(a("8460"),Object(c["a"])(f,m,p,!1,null,"555883ef",null)),b=h.exports,v=a("c405"),F=a("4c79"),y={components:{Basic:u,Sales:b},data(){return{options:[{value:"包邮，最晚次日达",label:"包邮，最晚次日达"}],dataForm:{price:"",price_off:"",unit:"",images:[],inventory:"",title:"",category:"",desc:"",sonCategory:"",tags:[],status:1},categoryList:[],active:1,productId:""}},async created(){let t="";if(t=await Object(v["a"])(),this.categoryList=t.data.data,this.$route.params.id){this.productId=this.$route.params.id,t=await F["d"](this.productId);const e=this.categoryList.filter(e=>e.id===t.data.category);console.log(t),this.dataForm={...t.data,sonCategory:t.data.c_item,category:e[0].name}}},methods:{next(){this.active+=1},prev(){this.active-=1},async handleSubmit(){console.log(this.dataForm);const t=this.dataForm.category,e=this.categoryList.filter(e=>e.name===t),a={...this.dataForm,category:e[0].id};let s="";s=this.productId?await F["b"](a):await F["a"](a),"success"===s.status?this.$message({message:"商品编辑成功",type:"success",onClose:()=>{this.$router.push("/commodity/list")}}):this.$message({message:s.msg,type:"error"})}}},w=y,_=(a("4c90"),Object(c["a"])(w,s,r,!1,null,null,null));e["default"]=_.exports},"4c79":function(t,e,a){"use strict";a.d(e,"c",(function(){return r})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return o})),a.d(e,"d",(function(){return l}));var s=a("365c");async function r(t){const e=await s["a"].get("/products/all",{params:t});return e}async function i(t){const e=await s["a"].post("/products/add",t);return e}async function o(t){const e=await s["a"].put("/products/edit",t);return e}async function l(t){const e=await s["a"].get("/products/"+t);return e}},"4c90":function(t,e,a){"use strict";a("1138")},8460:function(t,e,a){"use strict";a("cf3d")},"8be4":function(t,e,a){"use strict";a("f0ec")},c405:function(t,e,a){"use strict";a.d(e,"a",(function(){return r}));var s=a("365c");async function r(){const t=await s["a"].get("/category/all");return t}},cf3d:function(t,e,a){},f0ec:function(t,e,a){}}]);
//# sourceMappingURL=chunk-aba6595c.f3fa3c35.js.map